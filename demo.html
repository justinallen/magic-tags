<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Magic Tags jQuery Demo</title>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
	<style type="text/css">
		body {
			text-align: center;
			font-family: Edmondsans-bold;
			font-size: 150%;
			background-color: #2e2e2e;
			color: white;
			letter-spacing: .17em;
		}

		#magic-tags {
			text-shadow: 0px 0px 2px orange;
			font-size: 120%;
			line-height: 150%;
		/*	font-family: knewave; */
			width: 70%;
			margin: 0 auto;
		}

		#magic-tags a {
			color: #f06d06;
			padding: 5px;
			display: inline;
		}

		#magic-pressed {
			color: #cccccc !important;
		}

		#stuff {
	
		}

		#stuff ul {
			list-style-type: none;
			text-align: left;
			width: 50%;
			margin: 0 auto; 
		}

		#stuff ul li {
			border-bottom: 1px solid #f06d06;
			padding-bottom: 3px;
			margin-bottom: 3px;
		}


	</style>
</head>
<body>

<div id="magic-tags">

	<p>MAGIC TAGS</p>	
	
	<div id="magic-tags-box">
	</div>

</div>

<div id="stuff">
	<p> MY STUFF </p>	
	<ul>
		<li class="entry">cheese, iron, soil, knots, networking</li>
		<li class="entry">iphone, jalapeño, diesel, javascript</li>
		<li class="entry">jalapeño, iron, nails, sysadmin, knots</li>
		<li class="entry">cheese, wheels, iphone</li>
		<li class="entry">mangos, iron, javascript, sysadmin, networking</li>
		<li class="entry">diesel, doors, soil, iron</li>
	</ul>	
</div>


<script>

// get all the stuff into one big string

var entry = $("li.entry");
var stuff = entry.innerHTML;

// console.log("This is entry:");
// console.log(entry);

var longstring = "";

$(entry).each( function( index ) {

  // console.log( "Hello Ben" + index );
  // console.log( index + ": " + $(this).text() );
    longstring += $(this).text() + ", ";
	return longstring;

});

 // console.log("Hello ben");
 // console.log(longstring);

// got it all in a long string! 

// convert comma separated string to array

var stuffArray = longstring.split(',');

// console.log("This is stuffArray:");
// console.log(stuffArray);

// clean array of duplicates

var cleanList = stuffArray.reduce(function(a,b){
    if (a.indexOf(b) < 0 ) a.push(b);
    return a;
  },[]);


// console.log("This is cleanList:");
// console.log(cleanList);

var linkList = $('<p id="tags-output"></p>');

$.each( cleanList, function( index, value ) {
    // console.log( index + ": " + value );
    //  alert(index + ': ' + value);
	var text = value;
	var text = text.trim();
	var link = '<a class="magic-link" href="#' + text + '">' + text + '</a>'; 
	// console.log(link);
	$(link).appendTo(linkList);
});


var output = document.querySelectorAll("p.tags-output");

$(document).ready( function(){

	$("#magic-tags-box").html(linkList);
	
	$("<span> * </span>").insertAfter("a.magic-link");

	$('<a class="magic-link-show-all" href="#">Show All</a>').appendTo("#magic-tags-box");

	// ok, now I need a filter by click function

	$("a.magic-link").click( function() {

		$('a').removeAttr('id', 'magic-pressed');
		$(this).attr('id', 'magic-pressed');

		var word = $(this).html();
		// console.log(word);

		// for loop here to iterate over list
		// hide if does not contain word
		// if contains word and is currently hidden, show


		$("li.entry").each( function( index ) {

			// var myItem = $(this).html();
			// console.log(myItem);

			if ( $(this).text().indexOf(word) >= 0 ) {
				// show if hidden
				var whatIsThis = $(this);
				console.log(whatIsThis + " has a " + word);

				if ( $(this).is(":hidden") ) {
					$(this).slideDown();
				} 

			} else {
				// hide if shown
				var whatIsThis = $(this);
				console.log(whatIsThis + " does NOT have a " + word);

				if ( $(this).is(":visible") ) {
					$(this).slideUp();
				} 

			}


		});

	// end click handler
	});


	$("a.magic-link-show-all").click( function() {

		$('a').removeAttr('id', 'magic-pressed');
		$(this).attr('id', 'magic-pressed');

		$("li.entry").each( function( index ) {

			$(this).slideDown();

		});

	// end click handler
	});

});

</script>
</body>
</html>